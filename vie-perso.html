<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vie Perso</title>
  <link rel="stylesheet" href="style.css">
  
  <!-- Firebase SDK (Version compatibilitÃ©) -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  
  <!-- Configuration Firebase -->
  <script>
    // Configuration Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyDxC--WywLZ13NZdiouncGLb8SaE-3GggQ",
      authDomain: "site-perso-b7c08.firebaseapp.com",
      projectId: "site-perso-b7c08",
      storageBucket: "site-perso-b7c08.firebasestorage.app",
      messagingSenderId: "1015317206704",
      appId: "1:1015317206704:web:19e1d3762bda8a7cf78d75",
      measurementId: "G-MMLMV2DPNT"
    };
    
    // Initialiser Firebase
    document.addEventListener('DOMContentLoaded', function() {
      try {
        // VÃ©rifier si Firebase est dÃ©jÃ  initialisÃ©
        if (!firebase.apps.length) {
          firebase.initializeApp(firebaseConfig);
          console.log("âœ… Firebase initialisÃ©");
        }
        
        // Rendre Firebase accessible globalement
        window.firebase = firebase;
        window.db = firebase.firestore();
      } catch (error) {
        console.error("âŒ Erreur d'initialisation Firebase:", error);
      }
    });
  </script>
</head>
<body class="vie-perso">
  <header>
    <h1>ğŸ“… Vie Perso</h1>
    <nav>
      <button onclick="location.href='dashboard.html'">ğŸ“Š Dashboard</button>
      <button onclick="location.href='vie-perso.html'" class="active">ğŸ“… Vie Perso</button>
      <button onclick="location.href='finance.html'">ğŸ’° Finance</button>
      <button onclick="location.href='objectifs.html'">ğŸ¯ Objectifs</button>
      <button onclick="location.href='projets.html'">ğŸš€ Projets</button>
      <button onclick="location.href='nutrition.html'">ğŸ½ï¸ Nutrition</button>
      <button onclick="location.href='notes.html'">ğŸ“ Notes</button>
    </nav>
    <button onclick="logout()" class="logout">DÃ©connexion</button>
  </header>

  <main>
    <section class="info">
      <div>
        <p id="current-date">ğŸ“… Date : Chargement...</p>
        <p id="week-number">ğŸ”„ Semaine nÂ°...</p>
      </div>
    </section>

    <section>
      <h2>ğŸ“‹ Planning Hebdomadaire</h2>
      <div class="table-container">
        <table id="planning-table">
          <thead>
            <tr>
              <th>Heure</th>
              <th>Lundi</th>
              <th>Mardi</th>
              <th>Mercredi</th>
              <th>Jeudi</th>
              <th>Vendredi</th>
              <th>Samedi</th>
              <th>Dimanche</th>
            </tr>
          </thead>
          <tbody id="planning-body">
            <tr>
              <td colspan="8" style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                â³ Chargement du planning...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section>
      <h2>ğŸ¯ Objectifs Journaliers</h2>
      <div class="objectifs-grid" id="objectifs-container">
        <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
          â³ Chargement des objectifs...
        </div>
      </div>
    </section>

    <section>
      <h2>ğŸ’§ Suivi Hydratation</h2>
      <div class="hydration-tracker">
        <div class="hydration-header">
          <div class="hydration-goal">
            <span class="hydration-text">Objectif: 2L d'eau par jour</span>
            <span class="hydration-progress" id="hydration-progress">0/8 verres</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="hydration-fill" style="width: 0%"></div>
          </div>
        </div>
        
        <div class="water-glasses-large" id="water-glasses">
          <!-- Les verres seront ajoutÃ©s ici -->
        </div>
        
        <div class="hydration-controls-simple">
          <button onclick="addWaterGlass()" class="water-glass-btn">ğŸ’§ Ajouter un verre</button>
        </div>
      </div>
    </section>
    
    <div class="actions">
      <button onclick="saveWeek()" class="save">ğŸ’¾ Sauvegarder</button>
      <button onclick="downloadWeekPDF()" class="download">ğŸ“Š TÃ©lÃ©charger PDF</button>
      <button onclick="clearWeek()" class="clear">ğŸ—‘ï¸ Effacer Semaine</button>
      <button onclick="exportData()" class="export">ğŸ’¾ Export DonnÃ©es</button>
    </div>
  </main>

  <script src="script.js"></script>
  
  <script>
    // Mettre Ã  jour la navigation active
    document.addEventListener('DOMContentLoaded', function() {
      console.log("ğŸ”„ Initialisation de la page Vie Perso...");
      
      // Retirer la classe active de tous les boutons
      const navButtons = document.querySelectorAll('header nav button');
      navButtons.forEach(button => {
        button.classList.remove('active');
      });
      
      // Ajouter la classe active au bouton de la page actuelle
      const currentPage = window.location.pathname.split('/').pop();
      let activeButton = null;
      
      switch(currentPage) {
        case 'vie-perso.html':
          activeButton = document.querySelector('header nav button[onclick*="vie-perso"]');
          break;
        case 'finance.html':
          activeButton = document.querySelector('header nav button[onclick*="finance"]');
          break;
        case 'objectifs.html':
          activeButton = document.querySelector('header nav button[onclick*="objectifs"]');
          break;
        case 'projets.html':
          activeButton = document.querySelector('header nav button[onclick*="projets"]');
          break;
        case 'nutrition.html':
          activeButton = document.querySelector('header nav button[onclick*="nutrition"]');
          break;
        case 'dashboard.html':
          activeButton = document.querySelector('header nav button[onclick*="dashboard"]');
          break;
        case 'notes.html':
          activeButton = document.querySelector('header nav button[onclick*="notes"]');
          break;
      }
      
      if (activeButton) {
        activeButton.classList.add('active');
      }
      
      // Forcer l'initialisation si nÃ©cessaire
      setTimeout(function() {
        if (document.getElementById("planning-body").innerHTML.includes("Chargement")) {
          console.log("ğŸ”„ ForÃ§age du chargement du planning...");
          initializePage();
        }
      }, 1000);
    });
  </script>
</body>
</html>
